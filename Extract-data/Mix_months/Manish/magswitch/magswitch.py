import time
from typing import TextIO
from selenium.webdriver import Chrome
from selenium.webdriver.common.by import By
from selenium.common import exceptions
import pandas as pd


base_url = 'https://magswitch.com/collections'

driver = Chrome()

catalogue_urls = [
    'https://magswitch.com/collections/welding-fabrication',
    'https://magswitch.com/collections/lifting',
    'https://magswitch.com/collections/automation',
    'https://magswitch.com/collections/drills',
    'https://magswitch.com/collections/woodworking',
    'https://magswitch.com/collections/mounting-products',
    'https://magswitch.com/collections/accessories-parts',
    'https://magswitch.com/collections/shipyard-infrastructure-products',
    'https://magswitch.com/collections/magswitch-merchandise'
]
product_urls = ['https://magswitch.com/collections/welding-fabrication/products/magswitch-300-amp-ground-clamp-8100746',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-600-amp-ground-clamp-8100747',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-800-amp-ground-clamp-8100552',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magsquare-165-8100494',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magsquare-400-8100238',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magsquare-600-8100106',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magsquare-1000-8100099',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magjig-60-8100818',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magjig-95-8110004',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magjig-150-8110005',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magjig-235-8100377',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-pivot-angle-150-mini-81001269',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-pivot-angle-150max',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-pivot-angle-200-8100367',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-mini-angle-8100352',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-mini-multi-angle-8100350',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-mini-multi-angle-with-300-amp-8100351',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-mini-multi-angle-400-8100438',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-90-degree-angle-165-8100548',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-90-degree-angle-400-8100454',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-90-degree-angle-600-8100495',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-90-degree-angle-1000-8100503',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-boomerangle-150-8100091',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-boomerangle-400-8100453',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-boomerangle-600-8100090',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magvise-1000-8100450',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magvise-1500-8100897',
                'https://magswitch.com/collections/welding-fabrication/products/magdrilldisruptor55',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magdrill-disruptor-30-8100920',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magyoke-by-solo-magnetics-8100551',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magtether-300-8100111',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magtether-600-8100077',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-magtether-1000-8100051',
                'https://magswitch.com/collections/welding-fabrication/products/magswitch-mini-tool-wall-magnetic-tool-storage-and-display-kit', 'https://magswitch.com/collections/welding-fabrication/products/magswitch-magsquare-165-uh-8100610', 'https://magswitch.com/collections/lifting/products/magswitch-mlay600-lifting-magnet-8100089',
                'https://magswitch.com/collections/lifting/products/mlay600x2-lifting-magnet-8100360',
                'https://magswitch.com/collections/lifting/products/magswitch-mlay600x4-lifting-magnet-8100364',
                'https://magswitch.com/collections/lifting/products/magswitch-mlay1000-lifting-magnet-8100088',
                'https://magswitch.com/collections/lifting/products/magswitch-mlay-1000x2-8100484',
                'https://magswitch.com/collections/lifting/products/magswitch-mlay-1000x3-8100403', 'https://magswitch.com/collections/lifting/products/magswitch-mlay-1000x4-8100418', 'https://magswitch.com/collections/lifting/products/magswitch-mlay-1000x6-lifting-magnet-8100482', 'https://magswitch.com/collections/lifting/products/magswitch-mlay1000x12-8100549', 'https://magswitch.com/collections/lifting/products/magswitch-extenda-lift-600-8100025', 'https://magswitch.com/collections/lifting/products/magswitch-extenda-lift-1000-8130177', 'https://magswitch.com/collections/lifting/products/magswitch-hand-lifter-60-ce-8800487', 'https://magswitch.com/collections/lifting/products/magswitch-hand-lifter-60-m-8100359', 'https://magswitch.com/collections/lifting/products/magswitch-fixed-hand-lifter-235-8100795', 'https://magswitch.com/collections/lifting/products/magswitch-fixed-hand-lifter-400-8100810', 'https://magswitch.com/collections/lifting/products/magswitch-dual-hand-lifter-235-8100821', 'https://magswitch.com/collections/lifting/products/magswitch-dual-hand-lifter-400-8100822', 'https://magswitch.com/collections/lifting/products/magswitch-beam-press-accessory-8100553', 'https://magswitch.com/collections/lifting/products/magswitch-heavy-sheet-leveler-accessory-8100540', 'https://magswitch.com/collections/lifting/products/magreach-400-part-81001332', 'https://magswitch.com/collections/lifting/products/ce-440-magnetic-lifter-8140976', 'https://magswitch.com/collections/lifting/products/ce-1100-magnetic-lifter-8140977', 'https://magswitch.com/collections/lifting/products/ce-2100-magnetic-lifter-8140978', 'https://magswitch.com/collections/lifting/products/ce-6600-magnetic-lifter-8140979', 'https://magswitch.com/collections/lifting/products/ce-11000-magnetic-lifter-8140980', 'https://magswitch.com/collections/automation/products/magswitch-j30-81401003', 'https://magswitch.com/collections/automation/products/magswitch-j50-81401007', 'https://magswitch.com/collections/automation/products/magswitch-t30-81401124', 'https://magswitch.com/collections/automation/products/free-floating-sheet-fanner', 'https://magswitch.com/collections/automation/products/8140740-ar110', 'https://magswitch.com/collections/automation/products/8140320-ar70-classic', 'https://magswitch.com/collections/automation/products/magswitch-play30x7-81401193', 'https://magswitch.com/collections/automation/products/play70x4', 'https://magswitch.com/collections/automation/products/play70x3', 'https://magswitch.com/collections/automation/products/play70x2', 'https://magswitch.com/collections/automation/products/play50x4', 'https://magswitch.com/collections/automation/products/play50x3', 'https://magswitch.com/collections/automation/products/play50x2', 'https://magswitch.com/collections/automation/products/magswitch-t20-81401258', 'https://magswitch.com/collections/automation/products/m10ay-asc', 'https://magswitch.com/collections/automation/products/magswitch-ar50-2-0', 'https://magswitch.com/collections/automation/products/magswitch-e30-81401263', 'https://magswitch.com/collections/automation/products/magswitch-e50-81401227', 'https://magswitch.com/collections/automation/products/d85', 'https://magswitch.com/collections/automation/products/elay30x5', 'https://magswitch.com/collections/automation/products/elay50x5', 'https://magswitch.com/collections/automation/products/cobot-base-ur3-5', 'https://magswitch.com/collections/automation/products/cobot-base-ur10-16', 'https://magswitch.com/collections/automation/products/t30-laser-kit', 'https://magswitch.com/collections/automation/products/d120', 'https://magswitch.com/collections/drills/products/magswitch-magdrill-disruptor-30-8100920', 'https://magswitch.com/collections/drills/products/magdrilldisruptor55', 'https://magswitch.com/collections/drills/products/keyless-drill-chuck-1-2-20-thread', 'https://magswitch.com/collections/drills/products/adapter-3-4-weldon-1-2-20-thread', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-11-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-13-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-15-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-1-2-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-1-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-1-1-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-3-4-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-1-2-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-3-4-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-1-2-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/magdrill-disruptor-30-accessory-drill-chuck-keyed-13mm-1-2-20-thread-8800673', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-7-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-1-1-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-9-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-5-8-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-7-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-7-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-15-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-7-8-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-3-4-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-1-1-8-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-5-8-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-11-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-11-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-7-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-13-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-15-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-7-8-x55mm-weldon-2-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-11-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-9-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/tct-annular-cutter-13-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-7-8-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-3-4-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-3-4-x1-30-mm-1-depth-1', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-5-8-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-9-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-9-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/drills/products/1801126', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-13-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/drills/products/hss-annular-cutter-15-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/woodworking/products/magswitch-universal-featherboard-pro-81101303', 'https://magswitch.com/collections/woodworking/products/magswitch-vertical-featherboard-pro-81101302', 'https://magswitch.com/collections/woodworking/products/magswitch-universal-slot-indicator-81101304', 'https://magswitch.com/collections/woodworking/products/bandsawfeatherboarddiykit', 'https://magswitch.com/collections/woodworking/products/magswitch-woodworking-starter-kit-8110134', 'https://magswitch.com/collections/woodworking/products/magswitch-vertical-featherboard-w-risers-8110178', 'https://magswitch.com/collections/woodworking/products/magswitch-universal-featherboard-8110015', 'https://magswitch.com/collections/woodworking/products/magswitch-ultimate-thin-stock-jig-rip-guide-8110362', 'https://magswitch.com/collections/woodworking/products/magswitch-universal-mounting-base-8110112', 'https://magswitch.com/collections/woodworking/products/reversible-featherboard', 'https://magswitch.com/collections/woodworking/products/magswitch-pro-table-featherboard-8110328', 'https://magswitch.com/collections/woodworking/products/magswitch-dual-roller-guide-8110130', 'https://magswitch.com/collections/woodworking/products/magswitch-resaw-guide-8110125', 'https://magswitch.com/collections/woodworking/products/magswitch-universal-track-18-inch-8110132', 'https://magswitch.com/collections/woodworking/products/magswitch-universal-track-36-inch-8110370', 'https://magswitch.com/collections/woodworking/products/magswitch-magjig-60-8100818', 'https://magswitch.com/collections/woodworking/products/magswitch-magjig-95-8110004', 'https://magswitch.com/collections/woodworking/products/magswitch-magjig-150-8110005', 'https://magswitch.com/collections/woodworking/products/magswitch-magjig-235-8100377', 'https://magswitch.com/collections/woodworking/products/magswitch-magsquare-1000-8100099', 'https://magswitch.com/collections/woodworking/products/magswitch-magsquare-600-8100106', 'https://magswitch.com/collections/woodworking/products/magswitch-magsquare-165-8100494', 'https://magswitch.com/collections/woodworking/products/magswitch-magsquare-400-8100238', 'https://magswitch.com/collections/woodworking/products/magswitch-riser-kit', 'https://magswitch.com/collections/woodworking/products/drill-press-fence-pro', 'https://magswitch.com/collections/woodworking/products/drill-press-fence', 'https://magswitch.com/collections/woodworking/products/magswitch-universal-saw-indicator-metric-81101326', 'https://magswitch.com/collections/woodworking/products/magswitch-magjig-60-keychain-magnet-8100514', 'https://magswitch.com/collections/woodworking/products/magswitch-pink-magjig-60-keychain-magnet-81001519', 'https://magswitch.com/collections/woodworking/products/drill-press-vise-mount-81001385', 'https://magswitch.com/collections/woodworking/products/power-feeder-mount-81001386', 'https://magswitch.com/collections/woodworking/products/magswitch-power-feeder-m12-plate-kit', 'https://magswitch.com/collections/woodworking/products/magswitch-magsquare-165-uh-8100610', 'https://magswitch.com/collections/woodworking/products/magswitch-magmount-150-gripright-90-degree-switchable-magnet', 'https://magswitch.com/collections/mounting-products/products/magswitch-magmount-60keychain', 'https://magswitch.com/collections/mounting-products/products/magswitch-mag-utility-hook-25-8100012', 'https://magswitch.com/collections/mounting-products/products/magswitch-mag-utility-hook-40-8100006', 'https://magswitch.com/collections/mounting-products/products/magswitch-magmount-150-8100579', 'https://magswitch.com/collections/mounting-products/products/magswitch-magmount-235-8100451', 'https://magswitch.com/collections/mounting-products/products/magswitch-magmount-300-8100595', 'https://magswitch.com/collections/mounting-products/products/magswitch-magmount-400-8100523', 'https://magswitch.com/collections/mounting-products/products/magswitch-magmount-600-8100580', 'https://magswitch.com/collections/mounting-products/products/mag-utility-hook-25-orange', 'https://magswitch.com/collections/mounting-products/products/magswitch-magwheel-150-8100074', 'https://magswitch.com/collections/mounting-products/products/magswitch-magwheel-600-8100075', 'https://magswitch.com/collections/mounting-products/products/magswitch-magwheel-1000-8100250', 'https://magswitch.com/collections/mounting-products/products/magswitch-magwheel-95-8100401', 'https://magswitch.com/collections/mounting-products/products/magreach-400-part-81001332', 'https://magswitch.com/collections/mounting-products/products/drill-press-vise-mount-81001385', 'https://magswitch.com/collections/mounting-products/products/power-feeder-mount-81001386', 'https://magswitch.com/collections/mounting-products/products/magswitch-power-feeder-m12-plate-kit', 'https://magswitch.com/collections/mounting-products/products/magswitch-magmount-150-gripright-90-degree-switchable-magnet', 'https://magswitch.com/collections/accessories-parts/products/magswitch-hand-lifter-60-ce-replacement-4v-battery-cap-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-hand-lifter-60-ce-replacement-4v-battery-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-magjig-150-replacement-knob-kit', 'https://magswitch.com/collections/accessories-parts/products/replacement-knob-for-magswitch-hand-lifter-60-m-manual-and-magswitch-magjig-235', 'https://magswitch.com/collections/accessories-parts/products/magswitch-replacement-knob-kit-for-mini-multi-angle-and-magswitch-magjig-95', 'https://magswitch.com/collections/accessories-parts/products/30mm-forstner-bit', 'https://magswitch.com/collections/accessories-parts/products/40mm-forstner-bit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-m70-500-325-replacement-lift-ring-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-m50-300-225-replacement-lift-ring-kit', 'https://magswitch.com/collections/accessories-parts/products/kit-remote-control-e50x3', 'https://magswitch.com/collections/accessories-parts/products/12v-charger-kit-usa-e50x3', 'https://magswitch.com/collections/accessories-parts/products/magswitch-200amp-ground-clamp-clable-fasteners-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-pivot-angle-200-replacement-pivot-lock-handle', 'https://magswitch.com/collections/accessories-parts/products/magswitch-200-amp-ground-clamp-replacement-handle', 'https://magswitch.com/collections/accessories-parts/products/magswitch-300-amp-ground-clamp-replacement-handle', 'https://magswitch.com/collections/accessories-parts/products/magswitch-600-amp-ground-clamp-replacement-handle', 'https://magswitch.com/collections/accessories-parts/products/magswitch-boomerangles-replacement-adjustable-locking-handle-kit', 'https://magswitch.com/collections/accessories-parts/products/kit-mlay1000x2-std-pole-shoes', 'https://magswitch.com/collections/accessories-parts/products/magswitch-mlay1000x3-replacement-bearing-assembly-handle-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-m70-1680-840-replacement-lock-assembly-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-m70-1680-840-replacement-chain-assembly-kit', 'https://magswitch.com/collections/accessories-parts/products/magsquare-150-replacement-plunger-kit', 'https://magswitch.com/collections/accessories-parts/products/pilot-pin-1-4-x-4-euroboor-p-n-ibc-90', 'https://magswitch.com/collections/accessories-parts/products/magswitch-extenda-lift-600-50mm-valve-box-buddy-foot-bracket-kit', 'https://magswitch.com/collections/accessories-parts/products/ground-clamp-cable-fasteners-kit-for-the-magswitch-600-amp-ground-clamp-and-the-magswitch-300-amp-ground-clamp', 'https://magswitch.com/collections/accessories-parts/products/magswitch-hand-lifter-60-ce-4v-charger-kit-usa', 'https://magswitch.com/collections/accessories-parts/products/magsquare-600-replacement-handle', 'https://magswitch.com/collections/accessories-parts/products/kit-90-degree-support-bracket', 'https://magswitch.com/collections/accessories-parts/products/magswitch-extenda-lift-1000-70mm-valve-box-buddy-foot-bracket-kit', 'https://magswitch.com/collections/accessories-parts/products/extenda-lift-valve-box-buddy-replacement-handle-kit', 'https://magswitch.com/collections/accessories-parts/products/extenda-lift-valve-box-buddy-replacement-extended-shaft-kit', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-1-1-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-1-1-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-1-1-8-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-1-2-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-11-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-11-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-13-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-13-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-15-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-15-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-1-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-3-4-x1-30-mm-1-depth-1', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-3-4-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-3-4-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-5-8-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-5-8-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-7-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-7-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/kit-cage-assemby-e50x3', 'https://magswitch.com/collections/accessories-parts/products/1801126', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-7-8-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-9-16-x1-30-mm-1-depth', 'https://magswitch.com/collections/accessories-parts/products/hss-annular-cutter-9-16-x2-55-mm-2-depth', 'https://magswitch.com/collections/accessories-parts/products/hardware-kit-for-attachment-for-universal-base', 'https://magswitch.com/collections/accessories-parts/products/kit-battery-key-fob', 'https://magswitch.com/collections/accessories-parts/products/kit-antenna-e50x3', 'https://magswitch.com/collections/accessories-parts/products/kit-lay-50x3-std-pole-shoes', 'https://magswitch.com/collections/accessories-parts/products/kit-light-dome-cover', 'https://magswitch.com/collections/accessories-parts/products/kit-manual-actuation-lever-e50x3', 'https://magswitch.com/collections/accessories-parts/products/kit-mlay1000x3-std-pole-shoes', 'https://magswitch.com/collections/accessories-parts/products/kit-mlay1000x4-std-pole-shoes', 'https://magswitch.com/collections/accessories-parts/products/kit-mlay1000x6-std-pole-shoes', 'https://magswitch.com/collections/accessories-parts/products/kit-mlay600x2-std-pole-shoes', 'https://magswitch.com/collections/accessories-parts/products/adapter-3-4-weldon-1-2-20-thread', 'https://magswitch.com/collections/accessories-parts/products/kit-mlay600x4-std-pole-shoes', 'https://magswitch.com/collections/accessories-parts/products/mini-multi-angle-with-300amp-ground-replacement-t-handle', 'https://magswitch.com/collections/accessories-parts/products/magswitch-pivot-angle-200-replacement-on-off-handle-kit', 'https://magswitch.com/collections/accessories-parts/products/replacement-t-handle-kit-for-magswitch-boomerangle-150-magsquare-150-and-magswitch-90-degree-angle-150', 'https://magswitch.com/collections/accessories-parts/products/replacement-handle-for-magswitch-90-degree-angle-400-and-magswitch-magsquare-400', 'https://magswitch.com/collections/accessories-parts/products/replacementplunger', 'https://magswitch.com/collections/accessories-parts/products/replacement-plunger-kit-for-magswitch-extenda-lift-1000-valve-box-buddy-magsquare-600-and-magswitch-m50-300-225', 'https://magswitch.com/collections/accessories-parts/products/replacement-plunger-kit-for-m70-500-325-mlay1000-lifting-magnet-70mm-medium-duty-lifter-and-magsquare-1000', 'https://magswitch.com/collections/accessories-parts/products/t-handle-kit-for-magswitch-m50-300-225-mlay-600-lifting-magnet-single-50mm-medium-duty-lifter-magswitch-90-degree-angle-600-and-boomerangle-600', 'https://magswitch.com/collections/accessories-parts/products/replacement-t-handle-kit-for-m70-500-325-mlay1000-lifting-magnet-70mm-medium-duty-lifter-and-magswitch-magsquare-1000', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-1-2-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-1-2-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-11-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-11-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-13-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-13-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-15-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-15-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-3-4-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-3-4-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-5-8-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-7-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-7-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-7-8-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-7-8-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-9-16-x35mm-weldon-1-depth', 'https://magswitch.com/collections/accessories-parts/products/tct-annular-cutter-9-16-x55mm-weldon-2-depth', 'https://magswitch.com/collections/accessories-parts/products/magswitch-utility-hook-25-replacement-handle', 'https://magswitch.com/collections/accessories-parts/products/magswitch-riser-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-utility-hook-40-replacement-handle', 'https://magswitch.com/collections/accessories-parts/products/magswitch-automatic-on-cabinet-latch', 'https://magswitch.com/collections/accessories-parts/products/magdrill-disruptor-30-accessory-drill-chuck-keyed-13mm-1-2-20-thread-8800673', 'https://magswitch.com/collections/accessories-parts/products/magswitch-12lb-magnetic-cabinet-latch-m4', 'https://magswitch.com/collections/accessories-parts/products/keyless-drill-chuck-1-2-20-thread', 'https://magswitch.com/collections/accessories-parts/products/magswitch-12-lb-magnetic-cabinet-latch-8-32', 'https://magswitch.com/collections/accessories-parts/products/igus-mcm-08-02-bushing-for-8100238', 'https://magswitch.com/collections/accessories-parts/products/hand-sanitizer-station-81001379', 'https://magswitch.com/collections/accessories-parts/products/600042-universal-featherboard-plastic-mold-only', 'https://magswitch.com/collections/accessories-parts/products/600097-reversible-featherboard-plastic-mold-only', 'https://magswitch.com/collections/accessories-parts/products/coolant-nipple-quick-connect-disruptor-30', 'https://magswitch.com/collections/accessories-parts/products/spare-parts-kit-for-81101302', 'https://magswitch.com/collections/accessories-parts/products/mlay-1000x6-lifter-label-kit', 'https://magswitch.com/collections/accessories-parts/products/mlay-1000x4-kit-label', 'https://magswitch.com/collections/accessories-parts/products/kit-mlay-1000x3-labels', 'https://magswitch.com/collections/accessories-parts/products/kit-locking-latch-mlay600x4', 'https://magswitch.com/collections/accessories-parts/products/kit-magdrill-bushing', 'https://magswitch.com/collections/accessories-parts/products/kit-labels-50x2-lifter-1', 'https://magswitch.com/collections/accessories-parts/products/8800413-ar70-pin-clamp-pole-shoe-kit', 'https://magswitch.com/collections/accessories-parts/products/ar110-combo-pole', 'https://magswitch.com/collections/accessories-parts/products/ar50-2-combo-pole', 'https://magswitch.com/collections/accessories-parts/products/ar50-2-pin-pole', 'https://magswitch.com/collections/accessories-parts/products/t20-pin-pole', 'https://magswitch.com/collections/accessories-parts/products/t30-pin-pole', 'https://magswitch.com/collections/accessories-parts/products/t30-prox-kit', 'https://magswitch.com/collections/accessories-parts/products/e30-std-pole', 'https://magswitch.com/collections/accessories-parts/products/e30-v-pole', 'https://magswitch.com/collections/accessories-parts/products/elay30x-eoat', 'https://magswitch.com/collections/accessories-parts/products/play30x7-prox-kit', 'https://magswitch.com/collections/accessories-parts/products/t30-v-pole', 'https://magswitch.com/collections/accessories-parts/products/e30-thin-pole', 'https://magswitch.com/collections/accessories-parts/products/elay50x5-eoat', 'https://magswitch.com/collections/accessories-parts/products/t30-std-pole', 'https://magswitch.com/collections/accessories-parts/products/elay50x5-std-pole', 'https://magswitch.com/collections/accessories-parts/products/j30-std-pole', 'https://magswitch.com/collections/accessories-parts/products/j50-std-pole', 'https://magswitch.com/collections/accessories-parts/products/magmaster', 'https://magswitch.com/collections/accessories-parts/products/play30x7-std-pole', 'https://magswitch.com/collections/accessories-parts/products/t20-prox-kit', 'https://magswitch.com/collections/accessories-parts/products/t20-std-pole', 'https://magswitch.com/collections/accessories-parts/products/t20-thin-pole', 'https://magswitch.com/collections/accessories-parts/products/t20-v-pole', 'https://magswitch.com/collections/accessories-parts/products/t30-thin-pole', 'https://magswitch.com/collections/accessories-parts/products/elay30x5-thin-pole', 'https://magswitch.com/collections/accessories-parts/products/mount-285-ball-686-naams', 'https://magswitch.com/collections/accessories-parts/products/play30x7-thin-pole', 'https://magswitch.com/collections/accessories-parts/products/play50x2-prox-kit', 'https://magswitch.com/collections/accessories-parts/products/play50x3-4-70x2-prox-kit', 'https://magswitch.com/collections/accessories-parts/products/play70x3-4-prox-kit', 'https://magswitch.com/collections/accessories-parts/products/brkt-sensor-ar50-ar70', 'https://magswitch.com/collections/accessories-parts/products/smart-control-box', 'https://magswitch.com/collections/accessories-parts/products/resistor-can-f', 'https://magswitch.com/collections/accessories-parts/products/resistor-can-m', 'https://magswitch.com/collections/accessories-parts/products/elay30x5-std-pole', 'https://magswitch.com/collections/accessories-parts/products/d120-compliance', 'https://magswitch.com/collections/accessories-parts/products/magmount-handle-kit', 'https://magswitch.com/collections/accessories-parts/products/motor-switch-5-pin-110v-yellow', 'https://magswitch.com/collections/accessories-parts/products/updated-hex-handle-mlay600x2-4', 'https://magswitch.com/collections/accessories-parts/products/magswitch-magjig-60-keychain-magnet-8100514', 'https://magswitch.com/collections/accessories-parts/products/magswitch-pink-magjig-60-keychain-magnet-81001519', 'https://magswitch.com/collections/accessories-parts/products/magswitch-power-feeder-m12-plate-kit', 'https://magswitch.com/collections/accessories-parts/products/magswitch-stiffener-alignment-tool-8100554', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/6-ton-beam-jack', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-3-ton-beam-jack-8800605', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-1-5-ton-beam-jack-81001245', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-90-degree-angle-stiffener-1200-8100961', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-90-degree-angle-1000-8100503', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-magpress-8100935', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-extenda-lift-1000-8130177', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-extenda-lift-600-8100025', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-sheet-handler-8100361', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-magtether-1000-8100051', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-magtether-600-8100077', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-magtether-300-8100111', 'https://magswitch.com/collections/shipyard-infrastructure-products/products/magswitch-magdolly-8100433', 'https://magswitch.com/collections/magswitch-merchandise/products/magswitch-magmount-60keychain', 'https://magswitch.com/collections/magswitch-merchandise/products/official-hat-with-built-in-saftey-light', 'https://magswitch.com/collections/magswitch-merchandise/products/magswitch-magjig-60-keychain-magnet-8100514',
                'https://magswitch.com/collections/magswitch-merchandise/products/magswitch-pink-magjig-60-keychain-magnet-81001519']


def catalogue_url(url):
    driver.get(url)
    time.sleep(5)
    driver.maximize_window()
    # print(driver.current_url)
    # try:
    item_container = driver.find_element(By.CLASS_NAME, 'page-width').find_elements(By.XPATH, '//*[@id="shopify-section-list-collections-template"]/div/ul/li/div/a')
    if len(item_container) < 1:
        raise exceptions.StaleElementReferenceException
    print(driver.current_url)
    for item_link in item_container:
        catalogue_urls.append(item_link.get_attribute('href'))
        # print(item_link.get_attribute('href'))


def product_url(url):
    driver.get(url)
    try:
        # print("i'm in exception")
        item_container = driver.find_element(By.CLASS_NAME, 'page-width').find_elements(By.XPATH, '//*[@id="Collection"]/ul[1]/li/div/a')
        for item_link in item_container:
            print(item_link.get_attribute('href'))
            product_urls.append(item_link.get_attribute('href'))

        button = driver.find_element(By.XPATH, '//*[@id="Collection"]/ul[2]/li[3]/a').get_attribute('href')
        if button:
            product_url(button)
    except exceptions.NoSuchElementException:
        pass
    except exceptions.StaleElementReferenceException:
        pass
        # driver.back()


def product_details(url):
    driver.get(url)

    img_l = ''
    pdfs = ''
    features = ''
    desc = ''
    title = driver.find_element(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[1]/h1').text
    # print(title)
    price = driver.find_element(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[1]/div[2]/dl/div[1]/dd/span').text
    # print(price)
    try:
        features = driver.find_element(By.XPATH, "//div[@class='grid__item medium-up--one-half']//ul[1]").text.replace('\n',' ')
        print(features)
    except exceptions.NoSuchElementException:
        # image = driver.find_element(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[1]/noscript')
        desc = driver.find_element(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[2]').text.replace('\n', ' ').strip()
        print("djfkjdslj..................", desc)
        image = driver.find_element(By.XPATH, "//div[@class='grid__item product-single__photos medium-up--one-half']")
        ims = image.find_elements(By.TAG_NAME, "img")
        imgs_l = []
        for j in ims:
            imgs_l.append(j.get_attribute('src'))
        for img_l in imgs_l:
            save_d: TextIO = open('magswitch_1.txt', 'a+', encoding='utf-8')
            save_d.write("\n" + url + "\t" + title + "\t" + price + "\t" + features + "\t" + desc.strip() + "\t" + img_l.strip())
        print('\n', "save data into image and all file")

    try:
        details = driver.find_element(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[2]/ul[2]')
        description = details.find_elements(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[2]/p')
        desc = ''
        for specs in description:
            desc = f'{desc.strip()} {specs.text.strip()}'
        # print("desc", desc)

        image = driver.find_element(By.CLASS_NAME, 'thumbnails-wrapper').find_elements(By.TAG_NAME, 'a')
        for img in image:
            img_l = img.get_attribute('href')
            # print(img_l)
            save_d: TextIO = open('magswitch_1.txt', 'a+', encoding='utf-8')
            save_d.write("\n" + url + "\t" + title + "\t" + price + "\t" + features + "\t" + desc.strip() + "\t" + img_l.strip())
        print('\n', "save data into image and all file")

        pdf1 = details.find_elements(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[2]/ul[3]/li/a')
        pdf2 = details.find_elements(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[2]/ul[4]/li/a')
        pdfs1 = []
        for des in pdf1:
            pdfs1.append(des.get_attribute('href'))
        for des2 in pdf2:
            pdfs1.append(des2.get_attribute('href'))
        # print('pdfs1..', pdfs1)
        for pdfs in pdfs1:
            print(pdfs)
            save_d: TextIO = open('magswitch_1.txt', 'a+', encoding='utf-8')
            save_d.write("\n" + url + "\t" + title + "\t" + price + "\t" + features + "\t" + desc.strip() + "\t" + img_l + "\t" + pdfs.strip())
        print('\n', "save data into pdf and all file")

        specification = details.find_elements(By.XPATH, '//*[@id="ProductSection-product-template"]/div/div[2]/div[2]/ul[2]/li')
        i = 0
        name = []
        value = []
        for spec in specification:
            i += 1
            name.append(spec.text.split(':')[0])
            value.append(spec.text.split(':')[1])

        for a, b in zip(name, value):
            print(a, "....", b)
            save_d: TextIO = open('magswitch_1.txt', 'a+', encoding='utf-8')
            save_d.write("\n" + url + "\t" + title + "\t" + price + "\t" + features + "\t" + desc.strip() + "\t" + img_l + "\t" + pdfs + "\t" + a + "\t" + b.strip())
        print('\n', "save data into table and all file")

    except exceptions.NoSuchElementException:
        pass


def main():
    i = 350
    for url in product_urls[i:]:
        print(i)
        print(url)
        product_details(url)
        i += 1


main()
