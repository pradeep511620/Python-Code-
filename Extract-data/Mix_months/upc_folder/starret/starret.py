import time
from typing import TextIO
from selenium.webdriver.chrome.options import Options

from selenium import webdriver
from selenium.webdriver.common.by import By
headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"}
opts = Options()
opts.headless = True
browser = webdriver.Chrome()
browser.maximize_window()
url = 'https://www.turtle.com/1016738/Product/starrett-81-241j'
browser.get(url)

lst = [

    # 'rp_795.1XRL-1',
    # 'rp_256RL-1',
    # 'rp_569AXP',
    # 'rp_436.1XRL-5',
    # 'rp_ST436.1AXFLZ',
    # 'rp_ST436.1BXRLZ',
    # 'rp_S436.1CXRLZ',
    # 'rp_247A',
    # 'rp_247D',
    # 'rp_124AZ',
    # 'rp_124BZ',
    # 'rp_823AZ',
    # 'rp_823BZ',
    # 'rp_823EZ',
    # 'rp_440Z-3RL',
    # 'rp_440Z-6RL',
    # 'rp_445AZ-3RL',
    # 'rp_445BZ-6RL',
    # 'rp_261L',
    # 'rp_3202-12',
    # 'rp_1202F-6',
    # 'rp_120B-12',
    # 'rp_B120A-6',
    # 'rp_799AZ-24/600',
    # 'rp_PT22431',
    # 'rp_3751AZ-6/150',
    # 'rp_3752-12/300',
    # 'rp_643JZ',
    # 'rp_644JZ',
    # 'rp_81-141J',
    # 'rp_81-241J',
    # 'rp_25-341/5J',
    # 'rp_25R',
    # 'rp_711FSZ',
    # 'rp_711GCSZ',
    # 'rp_711LCSZ',
    # 'rp_811-5CZ',
    # 'rp_708AZ',
    # 'rp_708ACZ',
    # 'rp_709ACZ',
    # 'rp_657AA',
    # 'rp_657D',
    # 'rp_657EZ',
    # 'rp_657T',
    # 'rp_660',
    # 'rp_659A',
    # 'rp_659BZ',
    # 'rp_1015B-4',
    # 'rp_1010Z',
    # 'rp_S909Z',
    # 'rp_PT22938',
    # 'rp_PT62680-2',
    # 'rp_PT62606',
    # 'rp_PT26441',
    # 'rp_SRB-3',
    # 'rp_C11H-4-4R',
    # 'rp_C11H-6-4R',
    # 'rp_C435-12-4R',
    # 'rp_CB4-4R',
    # 'rp_CB6-4R',
    # 'rp_CB12-4R',
    # 'rp_CB12-16R',
    # 'rp_CB24-4R',
    # 'rp_H11-1224',
    # 'rp_C11-1224',
    # 'rp_H33-1224',
    # 'rp_CPNR-1224W',
    # 'rp_CPR-1224S',
    # 'rp_C331-300',
    # 'rp_C303R-6',
    # 'rp_C304SRE-6',
    # 'rp_C305R-24',
    # 'rp_C316R-6',
    # 'rp_C606R-6',
    # 'rp_C604RE-6',
    # 'rp_C607R-6',
    # 'rp_C635E-150',
    # 'rp_C334-150',
    # 'rp_C304R-24',
    # 'rp_C334-300',
    # 'rp_C636EM-6',
    # 'rp_380-12',
    # 'rp_380-36',
    # 'rp_385-24',
    # 'rp_385-48',
    # 'rp_S154LZ',
    # 'rp_C183',
    # 'rp_CP505A-12',
    # 'rp_505A-12',
    # 'rp_73A-4',
    # 'rp_73B-4',
    # 'rp_73A-6',
    # 'rp_73B-6',
    # 'rp_73B-8',
    # 'rp_73B-12',
    # 'rp_83A-6',
    # 'rp_83B-6',
    # 'rp_83A-8',
    # 'rp_83B-8',
    # 'rp_83A-12',
    # 'rp_275-6',
    # 'rp_277-6',
    # 'rp_S229GZ',
    # 'rp_269A',
    # 'rp_S579GZ',
    # 'rp_S829EZ',
    # 'rp_66',
    # 'rp_156M',
    # 'rp_159M',
    # 'rp_S167AZ',
    # 'rp_185',
    # 'rp_198',
    # 'rp_283',
    # 'rp_C391',
    # 'rp_467',
    # 'rp_472',
    # 'rp_474',
    # 'rp_572A',
    # 'rp_18AA',
    # 'rp_18C',
    # 'rp_819',
    # 'rp_S117PC',
    # 'rp_67A',
    # 'rp_67B',
    # 'rp_70A',
    # 'rp_70B',
    # 'rp_70BX',
    # 'rp_162A',
    # 'rp_162B',
    # 'rp_162C',
    # 'rp_S162Z',
    # 'rp_166A',
    # 'rp_166B',
    # 'rp_166D',
    # 'rp_240A',
    # 'rp_240C',
    # 'rp_240D',
    # 'rp_S240Z',
    # 'rp_248C',
    # 'rp_248D',
    # 'rp_248E',
    # 'rp_565D',
    # 'rp_S565WB',
    # 'rp_568C',
    # 'rp_S828HZ',
    # 'rp_706AZ',
    # 'rp_130',
    # 'rp_135B',
    # 'rp_RS 81.B',
    # 'rp_3020-3',
    # 'rp_3020-6',
    # 'rp_3020-12',
    # 'rp_B248B',
    # 'rp_B248D',
    # 'rp_B248E',
    # 'rp_B565B',
    # 'rp_B565C',
    # 'rp_B565D',
    # 'rp_B565E',
    # 'rp_B565F',
    # 'rp_B565H',
    # 'rp_SB565Z',
    # 'rp_765A',
    # 'rp_120A-6 W/SLC',
    # 'rp_120Z-12 W/SLC',
    # 'rp_25-441J W/SLC',
    # 'rp_T230XRL W/SLC',
    # 'rp_66B',
    # 'rp_237',
    # 'rp_237M',
    # 'rp_245',
    # 'rp_566',
    # 'rp_567',
    # 'rp_154E',
    # 'rp_154F',
    # 'rp_207Z',
    # 'rp_208DZ',
    # 'rp_208Z',
    # 'rp_25-141J',
    # 'rp_25-2041J',
    # 'rp_25-3041J',
    # 'rp_25-341J',
    # 'rp_25-4041J',
    # 'rp_25-611J',
    # 'rp_25-631J',
    # 'rp_25W',
    # 'rp_657Y',
    # 'rp_386-24',
    # 'rp_S4002-250',
    # 'rp_S4005-500',
    # 'rp_S4006-625',
    # 'rp_S4008-750',
    # 'rp_S4009-750',
    # 'rp_S4010-832',
    # 'rp_S4011-832',
    # 'rp_S4012-916',
    # 'rp_S4013-916',
    # 'rp_S4014-1',
    # 'rp_S4015-1',
    # 'rp_S668DZ',
    # 'rp_668',
    # 'rp_733XFLZ-2',
    # 'rp_733XFLZ-3',
    # 'rp_733XFLZ-4',
    # 'rp_733XFLZ-5',
    # 'rp_733XFLZ-6',
    # 'rp_220XRL-1',
    # 'rp_220MXRL-25',
    # 'rp_222XRL-1/2',
    # 'rp_222AXR-1',
    # 'rp_260Z',
    # 'rp_228XRL',
    # 'rp_T483XRL-1',
    # 'rp_T483XRL-2',
    # 'rp_3206',
    # 'rp_124CZ',
    # 'rp_823DZ',
    # 'rp_700A',
    # 'rp_700B',
    # 'rp_66MA',
    # 'rp_173MAT',
    # 'rp_667-3',
    # 'rp_667-4',
    # 'rp_667-5',
    # 'rp_667-8',
    # 'rp_667-9',
    # 'rp_667-10',
    # 'rp_667-11',
    # 'rp_667-13',
    # 'rp_667-14',
    # 'rp_667-15',
    # 'rp_667-16',
    # 'rp_667-19',
    # 'rp_667-21',
    # 'rp_667-22',
    # 'rp_667-23',
    # 'rp_667-24',
    # 'rp_667-26',
    # 'rp_667-27',
    # 'rp_667-29',
    # 'rp_806',
    # 'rp_806D',
    # 'rp_3753A-8/200',
    # 'rp_3753A-12/300',
    # 'rp_3648-180',
    # 'rp_3648-320',
    # 'rp_445BZ-9RL',
    # 'rp_445BZ-12RL',
    # 'rp_443Z-3RL',
    # 'rp_443Z-6RL',
    # 'rp_449AZ-3R',
    # 'rp_449BZ-6R',
    # 'rp_5006BZ-14/350',
    # 'rp_25-2081J',
    # 'rp_PT06632-6',
    # 'rp_PT06632-10',
    # 'rp_PT06632-14',
    # 'rp_PT06632-15',
    # 'rp_PT06677',
    # 'rp_PT06677B',
    # 'rp_196A5Z',
    # 'rp_661',
    # 'rp_S898Z-2',
    # 'rp_S909MZ',
    # 'rp_C404R-36',
    # 'rp_C404R-48',
    # 'rp_C404R-72',
    # 'rp_C635-1000',
    # 'rp_C636-500',
    # 'rp_385-72',
    # 'rp_13C',
    # 'rp_C434-12-16R',
    # 'rp_11MH-300',
    # 'rp_3089Z-131-26J',
    # 'rp_3089Z-131-715J',
    # 'rp_3089Z-131-1424J',
    # 'rp_S828',
    # 'rp_3732XFL-6',
    # 'rp_505P-7',
    # 'rp_798B-6/150 W/SLC',
    # 'rp_798B-8/200',
    # 'rp_798B-8/200 W/SLC',
    # 'rp_798B-12/300 W/SLC',
    # 'rp_172E',
    # 'rp_1025-6',
    # 'rp_C604R-36',
    # 'rp_58S',
    # 'rp_57S',
    # 'rp_25-241J',
    # 'rp_196A6Z',
    # 'rp_ST436.1AXRLZ',
    # 'rp_440Z-9RL',
    # 'rp_C304R-6',
    # 'rp_659P',
    # 'rp_V230MXRL',
    # 'rp_SF190',
    # 'rp_81-245J',
    # 'rp_172AT',
    # 'rp_CH604R-6',
    # 'rp_484',
    # 'rp_277-3',
    # 'rp_440Z-3L',
    # 'rp_T2XRL',
    # 'rp_57A',
    # 'rp_F190A',
    # 'rp_S190',
    # 'rp_S191',
    # 'rp_650A1Z',
    # 'rp_671',
    # 'rp_79A-8',
    # 'rp_C33H-6-4R',
    # 'rp_257D',
    # 'rp_98-4',
    # 'rp_196B6',
    # 'rp_657P',
    # 'rp_696Z',
    # 'rp_708MACZ',
    # 'rp_709BZ',
    # 'rp_S234J',
    # 'rp_234A-2',
    # 'rp_234A-5',
    # 'rp_234A-6',
    # 'rp_234A-9',
    # 'rp_234A-10',
    # 'rp_234A-11',
    # 'rp_234A-12',
    # 'rp_234A-14',
    # 'rp_234A-15',
    # 'rp_234A-16',
    # 'rp_234A-18',
    # 'rp_234A-20',
    # 'rp_234A-21',
    # 'rp_234A-22',
    # 'rp_234A-23',
    # 'rp_234A-24',
    # 'rp_234MA-25',
    # 'rp_234MA-50',
    # 'rp_234MA-100',
    # 'rp_234MA-125',
    # 'rp_234MA-150',
    # 'rp_234MA-175',
    # 'rp_234MA-200',
    # 'rp_234MA-225',
    # 'rp_234MA-250',
    # 'rp_234MA-275',
    # 'rp_234MA-300',
    # 'rp_234MA-325',
    # 'rp_234MA-350',
    # 'rp_234MA-375',
    # 'rp_234MA-400',
    # 'rp_234MA-425',
    # 'rp_234MA-450',
    # 'rp_234MA-475',
    # 'rp_234MA-500',
    # 'rp_234MA-525',
    # 'rp_234MA-550',
    # 'rp_234MA-575',
    # 'rp_234MA-600',
    # 'rp_798A-6/150',
    # 'rp_798A-8/200',
    # 'rp_80619',
    # 'rp_80646',
    # 'rp_80655',
    # 'rp_80622',
    # 'rp_80649',
    # 'rp_80658',
    # 'rp_80704',
    # 'rp_80625',
    # 'rp_80652',
    # 'rp_80661',
    # 'rp_80887',
    # 'rp_80707',
    # 'rp_80602',
    # 'rp_80611',
    # 'rp_80620',
    # 'rp_80629',
    # 'rp_80647',
    # 'rp_80656',
    # 'rp_80605',
    # 'rp_80614',
    # 'rp_80623',
    # 'rp_80632',
    # 'rp_80650',
    # 'rp_80659',
    # 'rp_80608',
    # 'rp_80617',
    # 'rp_80626',
    # 'rp_80635',
    # 'rp_80653',
    # 'rp_80662',
    # 'rp_80708',
    # 'rp_82220',
    # 'rp_82222',
    # 'rp_82224',
    # 'rp_82226',
    # 'rp_82228',
    # 'rp_82230',
    # 'rp_82266',
    # 'rp_82232',
    # 'rp_82234',
    # 'rp_82236',
    # 'rp_82238',
    # 'rp_82270',
    # 'rp_82240',
    # 'rp_82242',
    # 'rp_82244',
    # 'rp_82221',
    # 'rp_82223',
    # 'rp_82225',
    # 'rp_82227',
    # 'rp_82229',
    # 'rp_82231',
    # 'rp_82268',
    # 'rp_82233',
    # 'rp_82235',
    # 'rp_82237',
    # 'rp_82239',
    # 'rp_82272',
    # 'rp_82241',
    # 'rp_82243',
    # 'rp_82245',
    # 'rp_81802',
    # 'rp_81804',
    # 'rp_81565',
    # 'rp_81564',
    # 'rp_81568',
    # 'rp_81569',
    # 'rp_81573',
    # 'rp_81572',
    # 'rp_81576',
    # 'rp_81563',
    # 'rp_81562',
    # 'rp_81567',
    # 'rp_81566',
    # 'rp_81571',
    # 'rp_81570',
    # 'rp_81575',
    # 'rp_81574',
    # 'rp_81860',
    # 'rp_81864',
    # 'rp_81861',
    # 'rp_81865',
    # 'rp_81969',
    # 'rp_81961',
    # 'rp_81970',
    # 'rp_81962',
    # 'rp_81965',
    # 'rp_81919',
    # 'rp_81923',
    # 'rp_81608',
    # 'rp_81610',
    # 'rp_81612',
    # 'rp_81613',
    # 'rp_81648',
    # 'rp_81652',
    # 'rp_81653',
    # 'rp_81980',
    # 'rp_81981',
    # 'rp_81983',
    # 'rp_81691',
    # 'rp_81695',
    # 'rp_81699',
    # 'rp_81703',
    # 'rp_81692',
    # 'rp_81696',
    # 'rp_81700',
    # 'rp_81693',
    # 'rp_81697',
    # 'rp_81701',
    # 'rp_81705',
    # 'rp_81694',
    # 'rp_81698',
    # 'rp_81702',
    # 'rp_81706',
    # 'rp_81708',
    # 'rp_81710',
    # 'rp_83020',
    # 'rp_83021',
    # 'rp_83022',
    # 'rp_83023',
    # 'rp_83024',
    # 'rp_83025',
    # 'rp_83026',
    # 'rp_83034',
    # 'rp_83027',
    # 'rp_83028',
    # 'rp_83029',
    # 'rp_83030',
    # 'rp_83035',
    # 'rp_83031',
    # 'rp_83032',
    # 'rp_83033',
    # 'rp_81320',
    # 'rp_81321',
    # 'rp_81850',
    # 'rp_696B',
    # 'rp_27-24',
    # 'rp_117A',
    # 'rp_117E',
    # 'rp_434-12-4R',
    # 'rp_9-12-4R',
    # 'rp_445DZ-9RL',
    # 'rp_450-12',
    # 'rp_670B',
    # 'rp_196MA1Z',
    # 'rp_655-3041J',
    # 'rp_656-5041J',
    # 'rp_S253Z',
    # 'rp_823MAZ',
    # 'rp_224MARLZ',
    # 'rp_C604R-48',
    # 'rp_C616R-6',
    # 'rp_387-18',
    # 'rp_387-48',
    # 'rp_380-24 W/SLC',
    # 'rp_657H',
    # 'rp_S7793Z',
    # 'rp_269MA',
    # 'rp_269MB',

]

for i in lst:
    rp = i.replace("rp_", "")
    print("running_mpns....", rp)
    part = ''
#
    browser.find_element(By.XPATH, "//input[@id='txtSearchV1']").send_keys(rp)
    browser.find_element(By.XPATH, "//section[@id='autoSuggestionDiv']//button[@title='Search']").click()
    time.sleep(3)

    get_url = browser.current_url
    print("current = ", get_url)

    # close the clear button and clear search bar
    try:
        browser.find_element(By.XPATH, "//input[@id='txtSearchV1']").clear()
        time.sleep(1)
    except:
        pass

    try:
        title = browser.find_element(By.CLASS_NAME, "cimm_prodDetailTitle").text
        print("Title.....", title)
    except:
        title = "Not Found"
        print("Not Found")
    try:
        upc = browser.find_element(By.ID, "upcNo").text
        print("Upc.....", upc)
    except:
        upc = "Not Found"
        print("Not Found")

    try:
        mpn = browser.find_element(By.ID, "mPartNo").text
        print("Mpn.....", mpn)
    except:
        mpn = "Not Found"
        print("Not Found")

    try:
        part = browser.find_element(By.ID, "sitePartNo").text
        print("Part.....", part)
        save_data: TextIO = open("starett.text", 'a+', encoding='utf-8')
        save_data.write("\n" + url + "\t" + get_url + "\t" + title + "\t" + upc + "\t" + mpn + "\t" + part)
        print("\n", 'data store in text file')
    except:
        save_data: TextIO = open("starett.text", 'a+', encoding='utf-8')
        save_data.write("\n" + url + "\t" + get_url + "\t" + title + "\t" + upc + "\t" + mpn + "\t" + part)
        print("\n", 'data store in text file')
        part = "Not Found"


# browser.close()
