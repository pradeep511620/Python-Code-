import time
from typing import TextIO
from selenium.webdriver.chrome.options import Options
import requests
from selenium import webdriver
from selenium.webdriver.common.by import By
from bs4 import BeautifulSoup

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"}
opts = Options()
opts.headless = True
browser = webdriver.Chrome()
browser.maximize_window()
time.sleep(3)

url = 'https://www.turtle.com/1430404/Product/destaco-245-u'
browser.get(url)

lst = [
    # 'rp_205-SSS',
    # 'rp_305-U',
    # 'rp_307-U',
    # 'rp_309-U',
    # 'rp_305-USS',
    # 'rp_307-USS',
    # 'rp_309-USS',
    # 'rp_305-UR',
    # 'rp_307-UR',
    # 'rp_309-UR',
    # 'rp_105208',
    # 'rp_201208',
    # 'rp_202208',
    # 'rp_215208',
    # 'rp_225208',
    # 'rp_235208',
    # 'rp_240208',
    # 'rp_247208',
    # 'rp_267208',
    # 'rp_507208',
    # 'rp_527208',
    # 'rp_202208-M',
    # 'rp_215208-M',
    # 'rp_225208-M',
    # 'rp_240208-M',
    # 'rp_507208-M',
    # 'rp_317-U',
    # 'rp_205-S',
    # 'rp_217-U',
    # 'rp_225-U',
    # 'rp_227-U',
    # 'rp_235-U',
    # 'rp_237-U',
    # 'rp_205-USS',
    # 'rp_213-USS',
    # 'rp_215-USS',
    # 'rp_217-USS',
    # 'rp_225-USS',
    # 'rp_227-USS',
    # 'rp_2013-UR',
    # 'rp_2017-UR',
    # 'rp_2027-UR',
    # 'rp_225-UR',
    # 'rp_206-SS',
    # 'rp_235-UR',
    # 'rp_301',
    # 'rp_311',
    # 'rp_330',
    # 'rp_371',
    # 'rp_375',
    # 'rp_385',
    # 'rp_323-SS',
    # 'rp_331-SS',
    # 'rp_341-SS',
    # 'rp_330-SS',
    # 'rp_331-RSS',
    # 'rp_341-RSS',
    # 'rp_324',
    # 'rp_334',
    # 'rp_344',
    # 'rp_324-SS',
    # 'rp_334-SS',
    # 'rp_344-SS',
    # 'rp_331-R',
    # 'rp_341-R',
    # 'rp_375-R',
    # 'rp_385-R',
    # 'rp_81L12-10100',
    # 'rp_81L16-10100',
    # 'rp_81L16-14100',
    # 'rp_81L20-10100',
    # 'rp_81L20-14100',
    # 'rp_81L25-10100',
    # 'rp_81L25-14100',
    # 'rp_82L2G-2030000',
    # 'rp_82L2G-203B800',
    # 'rp_82L3G-2030000',
    # 'rp_82L3G-203B800',
    # 'rp_82L4G-2030000',
    # 'rp_82L4G-203B800',
    # 'rp_802-U',
    # 'rp_807-U',
    # 'rp_810-U',
    # 'rp_812-U',
    # 'rp_8021',
    # 'rp_8071',
    # 'rp_803',
    # 'rp_830',
    # 'rp_8031',
    # 'rp_8015',
    # 'rp_8116',
    # 'rp_8215',
    # 'rp_8216',
    # 'rp_8315',
    # 'rp_8316',
    # 'rp_8415',
    # 'rp_8416',
    # 'rp_89R32-010-2',
    # 'rp_89R40-010-2',
    # 'rp_89R40-025-2',
    # 'rp_89R50-025-2',
    # 'rp_89R63-025-2',
    # 'rp_9530-2L',
    # 'rp_9540-2L',
    # 'rp_9540-2R',
    # 'rp_9540150',
    # 'rp_9540153',
    # 'rp_8JG-215-1',
    # 'rp_8JG-217-1',
    # 'rp_8JG-218-1',
    # 'rp_8JG-219-1',
    # 'rp_8JG-220-1',
    # 'rp_323',
    # 'rp_331',
    # 'rp_341',
    # 'rp_351',
    # 'rp_381',
    # 'rp_351-SS',
    # 'rp_325',
    # 'rp_424',
    # 'rp_441',
    # 'rp_463',
    # 'rp_482',
    # 'rp_484',
    # 'rp_325-SS',
    # 'rp_607',
    # 'rp_609',
    # 'rp_650',
    # 'rp_6015-M',
    # 'rp_601',
    # 'rp_603',
    # 'rp_605',
    # 'rp_608',
    # 'rp_610',
    # 'rp_630',
    # 'rp_640',
    # 'rp_602',
    # 'rp_624',
    # 'rp_602-SS',
    # 'rp_604-SS',
    # 'rp_624-SS',
    # 'rp_603-SS',
    # 'rp_603-R',
    # 'rp_630-R',
    # 'rp_207206',
    # 'rp_210206',
    # 'rp_250206',
    # 'rp_468206',
    # 'rp_507206',
    # 'rp_468206-M',
    # 'rp_202',
    # 'rp_2002-U',
    # 'rp_2007-U',
    # 'rp_2010-U',
    # 'rp_2013-U',
    # 'rp_2017-U',
    # 'rp_201-U',
    # 'rp_2027-U',
    # 'rp_202-U',
    # 'rp_207-S',
    # 'rp_207-U',
    # 'rp_207-UL',
    # 'rp_210-S',
    # 'rp_210-U',
    # 'rp_247-U',
    # 'rp_267-U',
    # 'rp_201-USS',
    # 'rp_202-USS',
    # 'rp_207-USS',
    # 'rp_210-USS',
    # 'rp_2002-UR',
    # 'rp_2007-UR',
    # 'rp_2010-UR',
    # 'rp_207-UR',
    # 'rp_210-UR',
    # 'rp_604106',
    # 'rp_CPI-GPM-15-18',
    # 'rp_810151',
    # 'rp_810155',
    # 'rp_810158',
    # 'rp_202-TU',
    # 'rp_858',
    # 'rp_STS0013-NA',
    # 'rp_800',
    # 'rp_870-2',
    # 'rp_202-UB',
    # 'rp_207-LB',
    # 'rp_227-UB',
    # 'rp_602-MM',
    # 'rp_603-MR',
    # 'rp_210209',
    # 'rp_235208-M',
    # 'rp_307208-M',
    # 'rp_462',
    # 'rp_462-2',
    # 'rp_604-MM',
    # 'rp_609-B',
    # 'rp_202-UL',
    # 'rp_802-U-RC',
    # 'rp_841',
    # 'rp_891',
    # 'rp_6015-R',
    # 'rp_6015',
    # 'rp_5310-B',
    # 'rp_202-B',
    # 'rp_601-SS',
    # 'rp_CPI-PAT-75T-96',
    # 'rp_DLM-07M-25-25-P',
    # 'rp_RP-15',
    # 'rp_RPL-2',
    # 'rp_RPW-500-2',
    # 'rp_RR-36-180',
    # 'rp_RPL-4',
    # 'rp_235-USS',
    # 'rp_5130-MR',
    # 'rp_5105-BR',
    # 'rp_385-L-M-25',
    # 'rp_375-R-M-50',
    # 'rp_375-M-100',
    # 'rp_375-B-M-50',
    # 'rp_371-R-M-50',
    # 'rp_371-R-M-25',
    # 'rp_371-M-50',
    # 'rp_351-R-M-50',
    # 'rp_351-R-M-100',
    # 'rp_344-R-M-25',
    # 'rp_341-R-M-50',
    # 'rp_341-R-M-100',
    # 'rp_334-R-M-100',
    # 'rp_330-M-25',
    # 'rp_323-RSS-M-50',
    # 'rp_323-RSS-M-100',
    # 'rp_323-R-M-25',
    # 'rp_227-UB-L',
    # 'rp_217-U-L',
    # 'rp_217-UB',
    # 'rp_207-UB-L',
    # 'rp_2010-UBR',
    # 'rp_2010-SR',
    # 'rp_2007-SBR',
    # 'rp_2002-SR207',
    # 'rp_2010-SB',
    # 'rp_2010-SBR',
    # 'rp_202-UB-L',
    # 'rp_207-SB',
    # 'rp_207-TU',
    # 'rp_207-U-L',
    # 'rp_213-U-L',
    # 'rp_213-UB',
    # 'rp_217-UB-L',
    # 'rp_227-U-L',
    # 'rp_323-M-100',
    # 'rp_323-R-M-50',
    # 'rp_323-RSS-M-25',
    # 'rp_324-R-M-100',
    # 'rp_324-R-M-50',
    # 'rp_341-M-100',
    # 'rp_344-M-25',
    # 'rp_344-M-50',
    # 'rp_344-R-M-100',
    # 'rp_344-R-M-50',
    # 'rp_351-B-M-50',
    # 'rp_351-B-M-100',
    # 'rp_351-B-M-25',
    # 'rp_351-R-M-25',
    # 'rp_353-35',
    # 'rp_371-M-25',
    # 'rp_371-SS',
    # 'rp_375-B-M-100',
    # 'rp_374-M-50',
    # 'rp_375-B-M-25',
    # 'rp_503-MBLSC',
    # 'rp_506-MLBLSC',
    # 'rp_5105-B',
    # 'rp_5110-R',
    # 'rp_5130-BR',
    # 'rp_5130-MBR',
    # 'rp_5130-R',
    # 'rp_5131-BR',
    # 'rp_5131-MB',
    # 'rp_5131-MR',
    # 'rp_5133-MR',
    # 'rp_5133-MBR',
    # 'rp_5133-MB',
    # 'rp_5150-R',
    # 'rp_5150-MB',
    # 'rp_5150-MBR',
    # 'rp_5150-MR',
    # 'rp_6001-SS',
    # 'rp_6015-SS',
    # 'rp_602-MMSS',
    # 'rp_607-SQM',
    # 'rp_690-1MBPLS',
    # 'rp_803-ME',
    # 'rp_803-RC',
    # 'rp_807-SE',
    # 'rp_810-UE',
    # 'rp_817-U-LC',
    # 'rp_827-S-LC',
    # 'rp_82L4N-26300H0B',
    # 'rp_830-ME',
    # 'rp_847-S-LC',
    # 'rp_850-ME',
    # 'rp_858-E',
    # 'rp_868-E',
    # 'rp_FO-220',
    # 'rp_5305',
    # 'rp_695-1MBPLS',
    # 'rp_506-MBLSC',
    # 'rp_323-RSS',
    # 'rp_5131-B',
    # 'rp_604-MMSS',
    # 'rp_323-M-25',
    # 'rp_2002-S207',
    # 'rp_5310',
    # 'rp_5305-B',
    # 'rp_5150-M',
    # 'rp_807-U-RC',
    # 'rp_6004-MM',
    # 'rp_614-M',
    # 'rp_341-M-25',
    # 'rp_323-R-M-100',
    # 'rp_225-UBSS',
    # 'rp_812-U-RC',
    # 'rp_817-S-LC',
    # 'rp_2002-UBR',
    # 'rp_324-M-25',
    # 'rp_207-LBR',
    # 'rp_2002-SR',
    # 'rp_324-M-50',
    # 'rp_807-UE',
    # 'rp_807-S-RC',
    # 'rp_8007-E',
    # 'rp_8007-EHL',
    # 'rp_385-L-M-100',
    # 'rp_FO-162-60',
    # 'rp_2002-U207',
    # 'rp_3011',
    # 'rp_802-U-LC',
    # 'rp_630-MR',
    # 'rp_810-S-RC',
    # 'rp_5131-R',
    # 'rp_535-LB',
    # 'rp_351-M-25',
    # 'rp_5310-R',
    # 'rp_5310-BR',
    # 'rp_5905-B',
    # 'rp_324-R-M-25',
    # 'rp_6004',
    # 'rp_5915',
    # 'rp_5131-M',
    # 'rp_375-M-50',
    # 'rp_8007-EHR',
    # 'rp_334-R-M-50',
    # 'rp_846',
    # 'rp_827-S',
    # 'rp_205-SB',
    # 'rp_205-UB',
    # 'rp_206-HSS',
    # 'rp_601-O',
    # 'rp_615',
    # 'rp_620',
    # 'rp_F-160',
    # 'rp_FL-120',
    # 'rp_FL-121-45',
    # 'rp_FL-160',
    # 'rp_FL-161-60',
    # 'rp_FO-082-40',
    # 'rp_FO-120',
    # 'rp_FO-121-45',
    # 'rp_FO-122-45',
    # 'rp_FO-160',
    # 'rp_FO-161-60',
    # 'rp_G-082/40',
    # 'rp_G-121-45',
    # 'rp_210-TU',
    # 'rp_210-UB',
    # 'rp_351-M-50',
    # 'rp_351-M-100',
    # 'rp_503-MLBLSC',
    # 'rp_505-MLBLSC',
    # 'rp_505-MBLSC',
    # 'rp_247-UB',
    # 'rp_381-SS',
    # 'rp_374-M-25',
    # 'rp_G-122-45',
    # 'rp_317-S',
    # 'rp_527',
    # 'rp_847-U-RC',
    # 'rp_385-V2A',
    # 'rp_601-M',
    # 'rp_624-MM',
    # 'rp_603-M',
    # 'rp_605-M',
    # 'rp_607-M',
    # 'rp_610-M',
    # 'rp_620-M',
    # 'rp_630-M',
    # 'rp_640-M',
    # 'rp_650-M',
    # 'rp_7-101',
    # 'rp_7-58',
    # 'rp_7-59',
    # 'rp_7-60',
    # 'rp_807-S-LC',
    # 'rp_331-M-100',
    # 'rp_812-U-LC',
    # 'rp_2002-UR207',
    # 'rp_505-MB',
    # 'rp_341-M-50',
    # 'rp_301-SS',
    # 'rp_351-BSS',
    # 'rp_375-B',
    # 'rp_601-OSS',
    # 'rp_607-SQ',
    # 'rp_890',
    # 'rp_201-UB',
    # 'rp_578',
    # 'rp_374',
    # 'rp_431',
    # 'rp_486',
    # 'rp_371-R',
    # 'rp_91090',
    # 'rp_95030',
    # 'rp_95040',
    # 'rp_95050',
    # 'rp_95060',
    # 'rp_830-RC',
    # 'rp_345-G',
    # 'rp_2002-S',
    # 'rp_2002-UB',
    # 'rp_2007-S',
    # 'rp_2007-UB',
    # 'rp_2010-S',
    # 'rp_2010-UB',
    # 'rp_381-M-25',
    # 'rp_606',
    # 'rp_351-B',
    # 'rp_207-UB',
    # 'rp_334-M-25',
    # 'rp_207-SF',
    # 'rp_381-M-50',
    # 'rp_207-LR',
    # 'rp_210-SR',
    # 'rp_351-R',
    # 'rp_807-U-HT',
    # 'rp_330-M-50',
    # 'rp_330-M-100',
    # 'rp_810-U-RC',
    # 'rp_331-M-25',
    # 'rp_5105-R',
    # 'rp_344-M-100',
    # 'rp_334-R-M-25',
    # 'rp_817-SE',
    # 'rp_323-M-50',
    # 'rp_2007-SR',
    # 'rp_2007-UBR',
    # 'rp_5910-B',
    # 'rp_5133-B',
    # 'rp_5150-B',
    # 'rp_2007-SB',
    # 'rp_331-R-M-25',
    # 'rp_802-UE',
    # 'rp_213-UB-L',
    # 'rp_5133-R',
    # 'rp_6001',
    # 'rp_817-UE',
    # 'rp_5130-M',
    # 'rp_5150',
    # 'rp_3051',
    # 'rp_5130',
    # 'rp_5105',
    # 'rp_5131',
    # 'rp_5133',
    # 'rp_868-LC',
    # 'rp_847-U-LC',
    # 'rp_827-UE',
    # 'rp_827-SE',
    # 'rp_810-U-LC',
    # 'rp_810-SE',
    # 'rp_807-U-LC',
    # 'rp_807-S-HT',
    # 'rp_8021-UE',
    # 'rp_640-R',
    # 'rp_8071-UE',
    # 'rp_533-LB',
    # 'rp_5305-R',
    # 'rp_5131-MBR',
    # 'rp_5150-BR',
    # 'rp_5133-BR',
    # 'rp_5130-MB',
    # 'rp_528',
    # 'rp_424-2',
    # 'rp_205-UL',
    # 'rp_235-UB',
    # 'rp_528-F',
    # 'rp_205-SL',
    # 'rp_205-SR',
    # 'rp_207-ULB',
    # 'rp_861',
    # 'rp_225-UB',
    # 'rp_385-L',
    # 'rp_375-R-M-100',
    # 'rp_334-R',
    # 'rp_202-U-L',
    # 'rp_548',
    # 'rp_3051-R',
    # 'rp_344-R',
    # 'rp_847-S-RC',
    # 'rp_331-M-50',
    # 'rp_608-M',
    # 'rp_385-M-25',
    # 'rp_501-B',
    # 'rp_505-MLB',
    # 'rp_501-LB',
    # 'rp_207-UF',
    # 'rp_375-M-25',
    # 'rp_267-S',
    # 'rp_385-M-50',
    # 'rp_201-TU',
    # 'rp_202-SS',
    # 'rp_202-T',
    # 'rp_215-S',
    # 'rp_229',
    # 'rp_247-S',
    # 'rp_245-U',
    # 'rp_374-M-100',
    # 'rp_334-M-100',
    # 'rp_371-M-100',
    # 'rp_385-M-100',
    # 'rp_503-MLB',
    # 'rp_331-R-M-100',
    # 'rp_5133-M',
    # 'rp_5130-B',
    # 'rp_5305-BR',
    # 'rp_381-M-100',
    # 'rp_385-R-M-25',
    # 'rp_324-R',
    # 'rp_830-LC',
    # 'rp_810-S-LC',
    # 'rp_207-TUL',
    # 'rp_506-MB',
    # 'rp_375-BR',
    # 'rp_353-65',
    # 'rp_341-R-M-25',
    # 'rp_533-L',
    # 'rp_535-L',
    # 'rp_385-R-M-100',
    # 'rp_385-L-M-50',
    # 'rp_324-M-100',
    # 'rp_675-1MBPLS',
    # 'rp_425',
    # 'rp_435',
    # 'rp_6001-M',
    # 'rp_6001-MSS',
    # 'rp_6015-MR',
    # 'rp_6015-MSS',
    # 'rp_807-S',
    # 'rp_810-S',
    # 'rp_817-S',
    # 'rp_817-U',
    # 'rp_827-U',
    # 'rp_847-S',
    # 'rp_847-U',
    # 'rp_850',
    # 'rp_868',
    # 'rp_506-MLB',
    # 'rp_640-MR',
    # 'rp_323-R',
    # 'rp_858-LC',
    # 'rp_860',
    # 'rp_237-USS',
    # 'rp_331-R-M-50',
    # 'rp_2002-SBR',
    # 'rp_375-R-M-25',
    # 'rp_385-R-M-50',
    # 'rp_5110',
    # 'rp_5905',
    # 'rp_670-1MBPLS',
    # 'rp_371-R-M-100',
    # 'rp_827-U-LC',
    # 'rp_603-MSS',
    # 'rp_334-M-50',
    # 'rp_803-LC',
    # 'rp_215-UB',
    # 'rp_345',
    # 'rp_205-UR',
    # 'rp_840',
    # 'rp_201208-M',
    'rp_205208-M',

]
for i in lst:
    part = ''
    rp = i.replace("rp_", "")
    print("Product_urls...", url)
    print("running_mpns....", rp)
#
    browser.find_element(By.XPATH, "//input[@id='txtSearchV1']").send_keys(rp)
    print("send_key")
    browser.find_element(By.XPATH, "//section[@id='autoSuggestionDiv']//button[@title='Search']").click()
    print("click")
    time.sleep(3)

    get_url = browser.current_url
    print("current = ", get_url)

    try:
        browser.find_element(By.XPATH, "//input[@id='txtSearchV1']").clear()
    except:
        pass
#

    try:
        title = browser.find_element(By.CLASS_NAME, "cimm_prodDetailTitle").text
        print("Title.....", title)
    except:
        title = "Not Found"
        print("Not Found")

    try:
        upc = browser.find_element(By.ID, "upcNo").text
        print("Upc.....", upc)
    except:
        upc = "Not Found"
        print("Not Found")

    try:
        mpn = browser.find_element(By.ID, "mPartNo").text
        print("Mpn.....", mpn)
    except:
        mpn = "Not Found"
        print("Not Found")

    try:
        part = browser.find_element(By.ID, "sitePartNo").text
        print("Part.....", part)
        save_data: TextIO = open("starett.text", 'a+', encoding='utf-8')
        save_data.write("\n" + url + "\t" + get_url + "\t" + title + "\t" + upc + "\t" + mpn + "\t" + part)
        print("\n", 'data store in text file')
    except:
        save_data: TextIO = open("starett.text", 'a+', encoding='utf-8')
        save_data.write("\n" + url + "\t" + get_url + "\t" + title + "\t" + upc + "\t" + mpn + "\t" + part)
        print("\n", 'data store in text file')
        part = "Not Found"
        print("Not Found")
#
    # browser.back()
    # browser.find_element(By.XPATH, "//section[@id='autoSuggestionDiv']//button[@title='Search']").clear()
    # print("clear3")
    # time.sleep(5)
