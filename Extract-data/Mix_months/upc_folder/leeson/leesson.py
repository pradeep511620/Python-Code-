import time
from typing import TextIO

from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"}
opts = Options()
opts.headless = True
driver = webdriver.Chrome()
driver.maximize_window()

l = 0
url = 'https://us.rs-online.com/product/leeson/114889-00/72239318/'

l = l + 1
driver.get(url)
print("Product_urls", l, url)
time.sleep(3)

lst = [
    # 'rp_120998.00',
    # 'rp_113627.00',
    # 'rp_118015.00',
    # 'rp_110395.00',
    # 'rp_113925.00',
    # 'rp_114225.00',
    # 'rp_114231.00',
    # 'rp_114233.00',
    # 'rp_131459.00',
    # 'rp_131454.00',
    # 'rp_102694.00',
    # 'rp_117119.00',
    # 'rp_117121.00',
    # 'rp_117122.00',
    # 'rp_117127.00',
    # 'rp_193339.60',
    # 'rp_121879.00',
    # 'rp_M1125282.00',
    # 'rp_M1125283.00',
    # 'rp_M1125284.00',
    # 'rp_M1125285.00',
    # 'rp_M1145127.00',
    # 'rp_M1145129.00',
    # 'rp_M1145130.00',
    # 'rp_092111.00',
    # 'rp_092112.00',
    # 'rp_092114.00',
    # 'rp_098015.00',
    # 'rp_098066.00',
    # 'rp_100014.00',
    # 'rp_100053.00',
    # 'rp_100109.00',
    # 'rp_100123.00',
    # 'rp_100204.00',
    # 'rp_100205.00',
    # 'rp_100207.00',
    # 'rp_100208.00',
    # 'rp_100704.00',
    # 'rp_100723.00',
    # 'rp_100767.00',
    # 'rp_100802.00',
    # 'rp_100804.00',
    # 'rp_100824.00',
    # 'rp_100905.00',
    # 'rp_101015.00',
    # 'rp_101051.00',
    # 'rp_101341.00',
    # 'rp_101431.00',
    # 'rp_101520.00',
    # 'rp_101585.00',
    # 'rp_101637.00',
    # 'rp_101638.00',
    # 'rp_101646.00',
    # 'rp_101648.00',
    # 'rp_101649.00',
    # 'rp_101765.00',
    # 'rp_101766.00',
    # 'rp_101775.00',
    # 'rp_101776.00',
    # 'rp_101781.00',
    # 'rp_102862.00',
    # 'rp_102863.00',
    # 'rp_102869.00',
    # 'rp_102872.00',
    # 'rp_102873.00',
    # 'rp_102904.00',
    # 'rp_102917.00',
    # 'rp_102918.00',
    # 'rp_102965.00',
    # 'rp_102966.00',
    # 'rp_103020.00',
    # 'rp_103388.00',
    # 'rp_103389.00',
    # 'rp_103411.00',
    # 'rp_103412.00',
    # 'rp_103413.00',
    # 'rp_103715.00',
    # 'rp_103716.00',
    # 'rp_103794.00',
    # 'rp_103795.00',
    # 'rp_103821.00',
    # 'rp_108015.00',
    # 'rp_108226.00',
    # 'rp_108227.00',
    # 'rp_108228.00',
    # 'rp_108229.00',
    # 'rp_108230.00',
    # 'rp_108231.00',
    # 'rp_108232.00',
    # 'rp_108423.00',
    # 'rp_108424.00',
    # 'rp_108455.00',
    # 'rp_108458.00',
    # 'rp_109069.00',
    # 'rp_109070.00',
    # 'rp_109072.00',
    # 'rp_109078.00',
    # 'rp_109079.00',
    # 'rp_109082.00',
    # 'rp_109083.00',
    # 'rp_109089.00',
    # 'rp_110097.00',
    # 'rp_110144.00',
    # 'rp_110178.00',
    # 'rp_110182.00',
    # 'rp_110222.00',
    # 'rp_110288.00',
    # 'rp_110289.00',
    # 'rp_110915.00',
    # 'rp_110916.00',
    # 'rp_110934.00',
    # 'rp_111074.00',
    # 'rp_111075.00',
    # 'rp_111084.00',
    # 'rp_111267.00',
    # 'rp_111330.00',
    # 'rp_111915.00',
    # 'rp_111919.00',
    # 'rp_111923.00',
    # 'rp_111929.00',
    # 'rp_111938.00',
    # 'rp_111940.00',
    # 'rp_111962.00',
    # 'rp_113028.00',
    # 'rp_113280.00',
    # 'rp_113473.00',
    # 'rp_113583.00',
    # 'rp_113584.00',
    # 'rp_113591.00',
    # 'rp_113631.00',
    # 'rp_113641.00',
    # 'rp_113672.00',
    # 'rp_113891.00',
    # 'rp_113892.00',
    # 'rp_113893.00',
    # 'rp_114147.00',
    # 'rp_114155.00',
    # 'rp_114165.00',
    # 'rp_114201.00',
    # 'rp_114203.00',
    # 'rp_114207.00',
    # 'rp_114309.00',
    # 'rp_114311.00',
    # 'rp_114394.00',
    # 'rp_114626.00',
    # 'rp_114931.00',
    # 'rp_115779.00',
    # 'rp_115827.00',
    # 'rp_116201.00',
    # 'rp_116202.00',
    # 'rp_116346.00',
    # 'rp_116347.00',
    # 'rp_116523.00',
    # 'rp_116593.00',
    # 'rp_116599.00',
    # 'rp_116698.00',
    # 'rp_116699.00',
    # 'rp_116704.00',
    # 'rp_117273.00',
    # 'rp_117692.00',
    # 'rp_117698.00',
    # 'rp_117707.00',
    # 'rp_117715.00',
    # 'rp_117760.00',
    # 'rp_117859.00',
    # 'rp_117862.00',
    # 'rp_117864.00',
    # 'rp_117866.00',
    # 'rp_117906.00',
    # 'rp_117907.00',
    # 'rp_118008.00',
    # 'rp_119228.00',
    # 'rp_119229.00',
    # 'rp_119230.00',
    # 'rp_119231.00',
    # 'rp_119286.00',
    # 'rp_119289.00',
    # 'rp_119441.00',
    # 'rp_119463.00',
    # 'rp_119498.00',
    # 'rp_119512.00',
    # 'rp_119566.00',
    # 'rp_120374.00',
    # 'rp_120377.00',
    # 'rp_120379.00',
    # 'rp_120879.00',
    # 'rp_120946.00',
    # 'rp_120992.00',
    # 'rp_120994.00',
    # 'rp_120995.00',
    # 'rp_121009.00',
    # 'rp_121071.00',
    # 'rp_121199.00',
    # 'rp_121514.00',
    # 'rp_121675.00',
    # 'rp_121676.00',
    # 'rp_121815.00',
    # 'rp_121913.00',
    # 'rp_121920.00',
    # 'rp_121922.00',
    # 'rp_121934.00',
    # 'rp_121944.00',
    # 'rp_121973.00',
    # 'rp_122073.00',
    # 'rp_122075.00',
    # 'rp_122078.00',
    # 'rp_122081.00',
    # 'rp_122083.00',
    # 'rp_122085.00',
    # 'rp_122086.00',
    # 'rp_122087.00',
    # 'rp_122088.00',
    # 'rp_122089.00',
    # 'rp_122090.00',
    # 'rp_122091.00',
    # 'rp_122094.00',
    # 'rp_122095.00',
    # 'rp_122096.00',
    # 'rp_122097.00',
    # 'rp_122098.00',
    # 'rp_122099.00',
    # 'rp_122100.00',
    # 'rp_122101.00',
    # 'rp_122102.00',
    # 'rp_122103.00',
    # 'rp_122115.00',
    # 'rp_122180.00',
    # 'rp_122182.00',
    # 'rp_122198.00',
    # 'rp_122231.00',
    # 'rp_122245.00',
    # 'rp_131475.00',
    # 'rp_131509.00',
    # 'rp_131515.00',
    # 'rp_131517.00',
    # 'rp_131519.00',
    # 'rp_131520.00',
    # 'rp_131526.00',
    # 'rp_131541.00',
    # 'rp_131544.00',
    # 'rp_131605.00',
    # 'rp_131630.00',
    # 'rp_131640.00',
    # 'rp_131847.00',
    # 'rp_131849.00',
    # 'rp_131850.00',
    # 'rp_131881.00',
    # 'rp_131986.00',
    # 'rp_131988.00',
    # 'rp_132082.00',
    # 'rp_132197.00',
    # 'rp_132242.00',
    # 'rp_132244.00',
    # 'rp_132246.00',
    # 'rp_132247.00',
    # 'rp_132329.00',
    # 'rp_132393.00',
    # 'rp_132394.00',
    # 'rp_132425.00',
    # 'rp_132427.00',
    # 'rp_132440.00',
    # 'rp_132470.00',
    # 'rp_132472.00',
    # 'rp_132475.00',
    # 'rp_132479.00',
    # 'rp_132561.00',
    # 'rp_140155.00',
    # 'rp_140443.00',
    # 'rp_140444.00',
    # 'rp_140450.00',
    # 'rp_140451.00',
    # 'rp_140470.00',
    # 'rp_140472.00',
    # 'rp_140640.00',
    # 'rp_140641.00',
    # 'rp_140642.00',
    # 'rp_140646.00',
    # 'rp_140647.00',
    # 'rp_140665.00',
    # 'rp_140684.00',
    # 'rp_140685.00',
    # 'rp_140767.00',
    # 'rp_140769.00',
    # 'rp_140770.00',
    # 'rp_140806.00',
    # 'rp_140816.00',
    # 'rp_140830.00',
    # 'rp_140834.00',
    # 'rp_141084.00',
    # 'rp_141111.00',
    # 'rp_141119.00',
    # 'rp_141145.00',
    # 'rp_141146.00',
    # 'rp_141228.00',
    # 'rp_141231.00',
    # 'rp_141232.00',
    # 'rp_141233.00',
    # 'rp_141311.00',
    # 'rp_141312.00',
    # 'rp_170034.60',
    # 'rp_170071.60',
    # 'rp_170073.60',
    # 'rp_170138.60',
    # 'rp_170144.60',
    # 'rp_170165.60',
    # 'rp_170166.60',
    # 'rp_170167.60',
    # 'rp_170170.60',
    # 'rp_170172.60',
    # 'rp_170175.60',
    # 'rp_170197.60',
    # 'rp_171116.60',
    # 'rp_171564.60',
    # 'rp_171565.60',
    # 'rp_171566.60',
    # 'rp_171623.60',
    # 'rp_171851.60',
    # 'rp_810546.00',
    # 'rp_810548.00',
    # 'rp_811322.00',
    # 'rp_811546.00',
    # 'rp_811547.00',
    # 'rp_811548.00',
    # 'rp_811549.00',
    # 'rp_811550.00',
    # 'rp_811551.00',
    # 'rp_811553.00',
    # 'rp_811622.00',
    # 'rp_811644.00',
    # 'rp_824528.00',
    # 'rp_824529.00',
    # 'rp_824530.00',
    # 'rp_824532.00',
    # 'rp_825073.00',
    # 'rp_825085.00',
    # 'rp_825088.00',
    # 'rp_825127.00',
    # 'rp_A009581.00',
    # 'rp_A009595.00',
    # 'rp_A090405.00',
    # 'rp_A099250.00',
    # 'rp_A099836.00',
    # 'rp_A099946.00',
    # 'rp_E100010.00',
    # 'rp_E100023.00',
    # 'rp_E100025.00',
    # 'rp_E100027.00',
    # 'rp_E100056.00',
    # 'rp_E100356.00',
    # 'rp_E100375.00',
    # 'rp_E100446.00',
    # 'rp_E101449.00',
    # 'rp_E102695.00',
    # 'rp_E103014.00',
    # 'rp_E103017.00',
    # 'rp_E104018.00',
    # 'rp_E110028.00',
    # 'rp_E110052.00',
    # 'rp_E110111.00',
    # 'rp_E110433.00',
    # 'rp_E113608.00',
    # 'rp_E113894.00',
    # 'rp_E114197.00',
    # 'rp_E115827.00',
    # 'rp_E116756.00',
    # 'rp_E116762.00',
    # 'rp_E119352.00',
    # 'rp_E119361.00',
    # 'rp_E119362.00',
    # 'rp_E119854.00',
    # 'rp_E119856.00',
    # 'rp_E119860.00',
    # 'rp_LM06125',
    # 'rp_LM10336',
    # 'rp_LM10339',
    # 'rp_LM10340',
    # 'rp_LM10347',
    # 'rp_LM16033',
    # 'rp_LM16644',
    # 'rp_LM16741',
    # 'rp_LM20391',
    # 'rp_LM21159',
    # 'rp_LM21196',
    # 'rp_LM21199',
    # 'rp_LM21202',
    # 'rp_LM21378',
    # 'rp_LM24073',
    # 'rp_LM24074',
    # 'rp_LM24075',
    # 'rp_LM24076',
    # 'rp_LM24077',
    # 'rp_LM24083',
    # 'rp_LM24102',
    # 'rp_LM24114',
    # 'rp_LM24140',
    # 'rp_LM24154',
    # 'rp_LM24169',
    # 'rp_LM24199',
    # 'rp_LM24264',
    # 'rp_LM24265',
    # 'rp_LM24443',
    # 'rp_LM24492',
    # 'rp_LM24622',
    # 'rp_LM24683',
    # 'rp_LM24713',
    # 'rp_LM24719',
    # 'rp_LM24720',
    # 'rp_LM24721',
    # 'rp_LM24728',
    # 'rp_LM24729',
    # 'rp_LM24744',
    # 'rp_LM24776',
    # 'rp_LM24777',
    # 'rp_LM24780',
    # 'rp_LM24782',
    # 'rp_LM24788',
    # 'rp_LM24789',
    # 'rp_LM24790',
    # 'rp_LM24791',
    # 'rp_LM24792',
    # 'rp_LM24793',
    # 'rp_LM24795',
    # 'rp_LM24798',
    # 'rp_LM24871',
    # 'rp_LM25124',
    # 'rp_LM25135',
    # 'rp_LM28867',
    # 'rp_LM28868',
    # 'rp_LM28879',
    # 'rp_LM28968',
    # 'rp_LM29656',
    # 'rp_LM29657',
    # 'rp_LM29658',
    # 'rp_LM29659',
    # 'rp_LM29660',
    # 'rp_LM29663',
    # 'rp_LM29664',
    # 'rp_LM29665',
    # 'rp_LM29666',
    # 'rp_LM29667',
    # 'rp_LM29668',
    # 'rp_LM29669',
    # 'rp_LM29670',
    # 'rp_LM29671',
    # 'rp_LM29672',
    # 'rp_LM29673',
    # 'rp_LM30093',
    # 'rp_LM30094',
    # 'rp_LM30095',
    # 'rp_LM30096',
    # 'rp_LM32731',
    # 'rp_LM32740',
    # 'rp_LM32743',
    # 'rp_LM32796',
    # 'rp_LM32802',
    # 'rp_LM32822',
    # 'rp_LM32823',
    # 'rp_LM32829',
    # 'rp_LM33121',
    # 'rp_LM33123',
    # 'rp_LM33125',
    # 'rp_LM33563',
    # 'rp_LM34050',
    # 'rp_LM34051',
    # 'rp_LM34052',
    # 'rp_LM34053',
    # 'rp_LM34054',
    # 'rp_LM34055',
    # 'rp_LM34060',
    # 'rp_LM34069',
    # 'rp_LM34115',
    # 'rp_LM34145',
    # 'rp_LM34155',
    # 'rp_LM34158',
    # 'rp_LM80065',
    # 'rp_M099251.00',
    # 'rp_M1110025.00',
    # 'rp_M1110026.00',
    # 'rp_M1120013.00',
    # 'rp_M1120027.00',
    # 'rp_M1120040.00',
    # 'rp_M1120044.00',
    # 'rp_M1120046.00',
    # 'rp_M1120181.00',
    # 'rp_M1120182.00',
    # 'rp_M1120183.00',
    # 'rp_M1120185.00',
    # 'rp_M1130054.00',
    # 'rp_M1130055.00',
    # 'rp_M1130139.00',
    # 'rp_M1130141.00',
    # 'rp_M1130142.00',
    # 'rp_M1130143.00',
    # 'rp_M1130149.00',
    # 'rp_M1130207.00',
    'rp_M1130297.00',
    'rp_M1140171.00',
    'rp_M900277.00',

]

for i in lst:
    try:
        rp = i.replace("rp_", "")
        print("running_mpns....", rp)
        # try:
        sku = ''
        upc = ''
        rs = ''

        driver.find_element(By.ID, "search-bar-textfield").send_keys(rp)
        driver.find_element(By.ID, "search-bar-button-icon").click()
        time.sleep(3)
        current = driver.current_url
        print("Current_urls", current)

    #

        # close the clear button and clear search bar
        try:
            driver.find_element(By.XPATH, "//img[@alt='Clear Search']").click()
            time.sleep(1)
        except:
            pass

    #

        try:
            rs = driver.find_element(By.CLASS_NAME, "allied-stock-number").text.strip()
            print("Rs...", rs)
        except:
            rs = "Not Found"
            print("Not Found")
    #

        try:
            sku = driver.find_element(By.CLASS_NAME, 'manufacturer-part-number').text
            print("sku....", sku)
        except:
            sku = "Not Found"
            print("Not Found")

        try:
            upc = driver.find_element(By.ID, "attribute-16435").text.replace("\n", "-")
            print("upc...", upc)
            save_details: TextIO = open("leeson.txt", "a+", encoding="utf-8")
            save_details.write("\n" + url + "\t" + current + "\t" + rs + "\t" + sku + "\t" + upc)
            print("\n ***** Record stored into upc  files. *****")
        except:
            data_save: TextIO = open("leeson.txt", "a+", encoding="utf-8")
            data_save.write("\n" + url + "\t" + current + "\t" + rs + "\t" + sku + "\t" + upc)
            print("\n ***** Record stored into upc  files. *****")
            upc = "Not Found"
    except Exception as e:
        print(e)
